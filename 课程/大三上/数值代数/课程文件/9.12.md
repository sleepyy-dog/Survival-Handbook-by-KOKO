# 9.12

## 直接解法

> 目的：直接解决$Lx=b$

### L为三角矩阵

当为下三角时，即
$$
L = \begin{bmatrix} l_{11} & & & & \\ l_{21} & l_{22} & & & \\ l_{31} & l_{32} & l_{33} & & \\ \vdots & \vdots & \vdots & \ddots & \\ l_{n1} & l_{n2} & l_{n3} & \cdots & l_{nn} \end{bmatrix}
$$
此时由
$$
\sum_{i=1}^{j}l_{ji}x_i=b_j
$$
得到
$$
x_j=\frac{b_j-\sum_{i=1}^{j-1}l_{ji}x_i}{ljj},j\in\{1,2,...,n\}
$$
实现代码为

```matlab
x=ones(1:n);
for j=1:n
    x(j)=(b(j)-L(j,1:j-1)*x'(1:j-1))/L(j,j);
end
x
```

不太清楚对于$L(1,1:0)$是否会报错，如果会，应该参以下代码

```matlab
x=ones(1:n);
x(1)=b(1,1)/L(1,1)
for j=2:n
    x(j)=(b(j)-L(j,1:j-1)*x'(1:j-1))/L(j,j);
end
x
```

而对于上三角矩阵，相应得到的是
$$
x_j=\frac{b_j-\sum_{i=j+1}^{n}l_{ji}x_i}{ljj},j\in\{1,2,...,n\}
$$

```matlab
x=ones(1:n);
for j=n:-1:1
    x(j)=(b(j)-L(j,j+1:n)*x'(j+1:n))/L(j,j);
end
x
```

同理做的修改是

```matlab
x=ones(1:n);
x(n)=b(n,n)/L(n,n)
for j=n-1:-1:1
    x(j)=(b(j)-L(j,j+1:n)*x'(j+1:n))/L(j,j);
end
x
```



## Gauss变换

> 将矩阵A分解为下三脚矩阵$L$和上三角阵$U$的乘积。

初等下三角阵：
$$
L_k=E-l_k e_{k}’
$$
其中
$$
l_k=(0,0...,l_{k+1,k},l_{nk})，其中l_{i}=\frac{A_{ik}^{(k-1)}}{A_{kk}^{(k-1)}}
$$
此时

$$
L_k = \begin{bmatrix} 1 & & & & \\ & \ddots & & & \\ & & 1 & & \\ & & -l_{k+1,k} & 1 & \\ & & \vdots & & \ddots \\ & & -l_{n,k} & & & 1 \end{bmatrix}
$$
想法是以此找到这样$n$个初等下三角矩阵，使得$A^{(k-1)}$被以上矩阵左乘，得到的新矩阵为$A^{(k)}$的第$k$列的第$k+1$到$n$的元素为$0$。

也就是说$A^{(k)}$的前$k$列完成消去下方元素。$L_{k}$完成对于$A^{(k-1)}$的第$k$列的下方消元。

注意$A^{(0)}=A$。

得到
$$
L^{(n-1)}\cdot.....L^{(1)}A=U,其中U为上三角矩阵
$$

> #### 定理1.1.1　
>
> 
>
> #### 主元 $a_{ii}^{(i-1)}$ $(i = 1, \cdots, k)$ 均不为零的充分必要条件是 $A$ 的 $i$ 阶顺序主子阵 $A_i$ $(i = 1, \cdots, k)$ 都是非奇异的。

> #### 定理 1.1.2　
>
> 
>
> #### 若 $A \in \mathbf{R}^{n \times n}$ 的顺序主子阵 $A_k \in \mathbf{R}^{k \times k}$ $(k = 1, \cdots, n - 1)$ 均非奇异，则存在唯一的单位下三角阵 $L \in \mathbf{R}^{n \times n}$ 和上三角阵 $U \in \mathbf{R}^{n \times n}$，使得 $A = LU$。

注意到以上算法我们有一个需要注意到的地方是我们的
$$
A_{kk}^{(k-1)}\neq 0,k\in\{0,1,2,...,n-1\}
$$
这也我们引入以上两个命题的目的。