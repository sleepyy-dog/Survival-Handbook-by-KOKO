# 策略：Unilend 逻辑漏洞利用

## 1. 目标

本策略旨在复现 2025 年 1 月 12 日针对 Unilend Finance 的真实攻击。该攻击利用了其合约中的一个逻辑缺陷（可被视为一种重入攻击），导致攻击者能够以极低的成本取走协议中的抵押品。

## 2. 攻击流程

整个攻击序列被捆绑在由 `UniversalInterpreter` 合约执行的单笔交易中。

1.  **准备工作**：攻击者首先向 Unilend 的 stETH 市场提供极少量的 stETH 作为抵押品，从而成为一个“合法”的借款人。
2.  **发起闪电贷**：攻击者从同一个 stETH 市场请求一笔闪电贷。
3.  **恶意回调**：在闪电贷的回调函数 (`executeOperation`) 内部，在偿还贷款之前，攻击合约调用 Unilend 合约的 `redeem` 函数，赎回（偷走）在步骤 1 中存入的抵押品以及池中其他用户的抵押品。由于合约逻辑缺陷，此时的赎回检查会被绕过。
4.  **偿还闪电贷**：攻击者按要求偿还闪电贷本金及费用。
5.  **利润**：完成上述步骤后，攻击者成功地利用闪电贷资金作为杠杆，在几乎没有初始资本的情况下盗取了池中的 stETH 抵押品。

## 3. 如何验证

-   **验证目标**：脚本应检查 `UniversalInterpreter` 合约在交易前后的 stETH 余额。
-   **预期结果**：交易执行后，合约的 stETH 余额应显著增加，代表盗取的利润。
